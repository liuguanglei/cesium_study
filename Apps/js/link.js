function LineLineChart(){function l(){if(G){if(q&&0!=q.length){k(q);var a={},c=[],b=[],e=[],f=q.length,d=0,g,m,v;y=normalUtils.getItemOnlyAtt(q[0],"f_value");z=normalUtils.getItemOnlyAtt(q[0],"t_value");for(g=0;g<f;g++)m=q[g],m.hasOwnProperty(w)&&(d=parseFloat(m[w]),m.hasOwnProperty(p)&&m.hasOwnProperty(r)&&(a.hasOwnProperty("f_"+m[p])?a["f_"+m[p]][y]+=d:(v=normalUtils.copyObj(m,","+r+","+w+","+F+","),v[y]=d,a["f_"+m[p]]=v,b.push(v)),a.hasOwnProperty("t_"+m[r])?a["t_"+m[r]][z]+=d:(v=normalUtils.copyObj(m,
	","+p+","+R+","+w+","),v[z]=d,v[F]=m[F],a["t_"+m[r]]=v,e.push(v)),c.push(m)));A(b);H(c);Ia(e)}}else if(I&&0!=I.length&&J&&0!=J.length&&q&&0!=q.length){k(q);a={};c=[];b=[];e=[];f=q.length;v=0;for(var l,d=0;d<f;d++)l=q[d],l.hasOwnProperty(w)&&(v=parseFloat(l[w]),l.hasOwnProperty(p)&&l.hasOwnProperty(r)&&(g="f_"+l[p],m="t_"+l[r],a.hasOwnProperty(g)?a[g]+=v:a[g]=v,a.hasOwnProperty(m)?a[m]+=v:a[m]=v,c.push(l)));y=normalUtils.getItemOnlyAtt(I[0],"f_value");f=I.length;for(d=0;d<f;d++)m=I[d],g="f_"+m[p],
	a.hasOwnProperty(g)?m[y]=a[g]:m[y]=0,b.push(m);z=normalUtils.getItemOnlyAtt(J[0],"t_value");f=J.length;for(d=0;d<f;d++)g=J[d],m="t_"+g[r],a.hasOwnProperty(m)?g[z]=a[m]:g[z]=0,e.push(g);A(b);H(c);Ia(e)}ab();bb();cb();Ja=setInterval(h,1)}function h(){if(0==L.length)clearInterval(Ja);else{for(var a=0;a<Ka;a++)0<L.length&&da.push(L.pop());Ka=30;db(da)}}function t(){S=[];G?ea(M,function(a){q=a;fa()}):(ea(ga,function(a){I=a;fa()}),ea(M,function(a){q=a;fa()}),ea(ha,function(a){J=a;fa()}));eb()}function k(a){if(!w){w=
	normalUtils.getItemOnlyAtt(a[0],"link_value");for(var c=a.length,b=0;b<c;b++)a[b][w]=1}}function A(a){K=new HasMap;for(var c=0;c<a.length;c++){var b=a[c];b.value=Number(b[y]);fb.push(b);var e=b[R];K.hasKey(e)?(e=K.getChild(e),e.total+=b.value,e.list.push(b)):K.addChild(e,{type:e,total:b.value,list:[b]})}}function H(a){var c=0;a.forEach(function(a){a.Key="H"+c++;gb.push(a);La.push(a)})}function Ia(a){T=a;for(a=0;a<T.length;a++)D["data_"+T[a][r]]=T[a]}function ab(){da=[];oa=[];U=[];L=[];for(var a={},
		                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              c=[],b=K.getValueList(),e=0;e<b.length;e++)c.push({value:b[e].total,children:b[e].list});a.children=c;a.PTY="root";Ma=Na.nodes(a);Ma.forEach(function(a){2==a.depth&&(N[a[p]]=a,a.relatedLinks=[],a.Amount=Number(a[y]),a.currentAmount=a[y],oa.push(a))});U=T;La.forEach(function(a){L.push(a)});hb();L.forEach(function(a){N[a[p]].relatedLinks.push(a);O[a[r]].relatedLinks.push(a)})}function hb(){var a=[];Oa=[];V=[];for(var c=0;c<U.length;c++){var b={};b.index=c;b.label="null";b.angle=0;Oa.push(b);V.push({label:"null",
	source:{},target:{}})}W=[];pa=[];n=0;U.forEach(function(a){a=a[r];a in W||(pa[n]=a,W[a]=n++)});U.forEach(function(b){var c=W[b[r]],d=a[c];if(!d)for(d=a[c]=[],c=-1;++c<n;)d[c]=0;d[W[b[r]]]=Number(b[z])});qa.matrix(a);V=qa.chords();c=0;V.forEach(function(a){a.label=pa[a.source.index];a.angle=(a.source.startAngle+a.source.endAngle)/2;var b={};b.startAngle=a.source.startAngle;b.endAngle=a.source.endAngle;b.index=a.source.index;b.value=a.source.value;b.currentAngle=a.source.startAngle;b.currentLinkAngle=
	a.source.startAngle;b.Amount=a.source.value;b.source=a.source;b.relatedLinks=[];O[a.label]=b;c++})}function db(a){ia=Pa.selectAll("g.links").data(a,function(a,b){return a.Key});a=ia.enter().append("g").attr("class","links");ia.transition();a.append("g").attr("class","arc").append("path").attr("id",function(a){return"a_"+a.Key}).style("fill",function(a){return P(a,0)}).style("fill-opacity",.2).attr("d",function(a,b){var e={},f=O[a[r]];e.startAngle=f.currentAngle;f.currentAngle+=Number(a[w])/f.value*
(f.endAngle-f.startAngle);e.endAngle=f.currentAngle;e.value=Number(a[w]);return d3.svg.arc(a,b).innerRadius(X).outerRadius(x)(e,b)}).on("mouseover",function(a){ja(a,"link")}).on("mouseout",function(a){ka(a,"link")});a.append("path").attr("class","link").attr("id",function(a){return"l_"+a.Key}).attr("d",function(a,b){var e={},f={},d={},g={},k={},h=O[a[r]],l=N[a[p]],q=X;Math.cos(h.currentLinkAngle-1.57079633);Math.sin(h.currentLinkAngle-1.57079633);var t=h.currentLinkAngle-1.57079633;h.currentLinkAngle+=
	Number(a[w])/h.value*(h.endAngle-h.startAngle);h=h.currentLinkAngle-1.57079633;f.x=q*Math.cos(t);f.y=q*Math.sin(t);e.x=l.x-(E-Y);e.y=l.y-(E-Y);k.x=q*Math.cos(h);k.y=q*Math.sin(h);d.source=f;d.target=e;g.source=e;g.target=k;a.links=[d,g];e=ra(a.links[0],b);e+="L"+String(ra(a.links[1],b)).substr(1);return e+="A"+X+","+X+" 0 0,0 "+a.links[0].source.x+","+a.links[0].source.y}).style("stroke",function(a){return P(a,0)}).style("stroke-opacity",.07).style("fill-opacity",.1).style("fill",function(a){return P(a,
	0)}).on("mouseover",function(a){ja(a,"link")}).on("mouseout",function(a){ka(a,"link")});a.append("g").attr("class","node").append("circle").style("fill",function(a){return P(a,0)}).style("fill-opacity",.2).style("stroke-opacity",1).attr("r",function(a){var b=N[a[p]];b.currentAmount-=Number(a[w]);return(b.Amount-b.currentAmount)/b.Amount*b.r}).attr("transform",function(a,b){return"translate("+a.links[0].target.x+","+a.links[0].target.y+")"});ia.exit().remove()}function bb(){var a=Qa.selectAll("g.node").data(oa,
	function(a,c){return a[p]}),c=a.enter().append("g").attr("class","node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"});c.append("circle").attr("r",function(a){return a.r}).style("fill-opacity",function(a){return 2>a.depth?0:Ra}).style("stroke",function(a){return P(a,0)}).style("stroke-opacity",function(a){return 2>a.depth?0:Sa}).style("fill",function(a){return P(a,0)});c=c.append("g").attr("id",function(a){return"c_"+a[p]}).style("opacity",0);c.append("circle").attr("r",function(a){return a.r+
	2}).style("fill-opacity",0).style("stroke","#FFF").style("stroke-width",2.5).style("stroke-opacity",.7);c.append("circle").attr("r",function(a){return a.r}).style("fill-opacity",0).style("stroke","#000").style("stroke-width",1.5).style("stroke-opacity",1).on("mouseover",function(a){ja(a,"from")}).on("mouseout",function(a){ka(a,"from")});a.exit().remove().transition(500).style("opacity",0)}function cb(){var a=Ta.selectAll("g.arc").data(V,function(a){return a.label}),c=a.enter().append("g").attr("class",
	"arc");c.append("text").attr("class","chord").attr("dy",".35em").attr("text-anchor",function(a){return a.angle>Math.PI?"end":null}).attr("transform",function(a){return"rotate("+(180*a.angle/Math.PI-90)+")translate("+(x+6)+")"+(a.angle>Math.PI?"rotate(180)":"")}).text(function(a){return Ua(D["data_"+a.label][r])}).on("mouseover",function(a){ja(a,"to")}).on("mouseout",function(a){ka(a,"to")});a.transition().select("text").attr("id",function(a){return"t_"+a.label}).attr("dy",".35em").attr("text-anchor",
	function(a){return a.angle>Math.PI?"end":null}).attr("transform",function(a){return"rotate("+(180*a.angle/Math.PI-90)+")translate("+(x+6)+")"+(a.angle>Math.PI?"rotate(180)":"")}).style("fill",sa).style("cursor","default").text(function(a){return Ua(D["data_"+a.label][F])});c.append("path").style("fill-opacity",0).style("stroke",Va).style("stroke-opacity",Wa).attr("d",function(a,c){return d3.svg.arc(a,c).innerRadius(x-20).outerRadius(x)(a.source,c)});a.transition().select("path").attr("d",function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          c){return d3.svg.arc(a,c).innerRadius(x-20).outerRadius(x)(a.source,c)});a.exit().remove()}function P(a,c){var b=N[a[p]];b.hasOwnProperty(R)&&(b=b[R],c=K.hasKey(b)?K.getKeyIndex(b):0);-1==c&&(c=0);return ta[c%ta.length]}function Ua(a){return 15<a.length?String(a).substr(0,15)+"...":a}function ea(a,c){var b={};b.file=a;b.function=c;S.push(b)}function eb(){ua=S.length;S.forEach(function(a){d3.csv(a.file,a.function)})}function fa(){ua--;0==ua&&l()}function ja(a,c){if("from"==c)2>a.depth||(Q.transition().duration(200).style("opacity",
	".9"),u.text(""),Z?a.hasOwnProperty(Z)?B.text(a[Z]):B.text(Z):a.hasOwnProperty(p)&&B.text(a[p]),va?u.html(va(a)):wa?u.text(wa(a)):a.hasOwnProperty(xa)?u.text(a[xa]):u.text(a[y]+""),ya(d3.event.pageX,d3.event.pageY),la(a,!0));else if("link"==c){Q.transition().duration(200).style("opacity",".9");u.text("");aa?a.hasOwnProperty(aa)?B.text(a[aa]):B.text(aa):B.text(a[p]+" -- "+a[r]);if(za)u.html(za(a));else if(Aa){var b=Aa(a);u.text(b)}else a.hasOwnProperty(Ba)?u.text(a[Ba]):u.text(a[w]);ya(d3.event.pageX,
	d3.event.pageY);Ca(a,!0)}else"to"==c&&(Q.transition().duration(200).style("opacity",".9"),u.text(""),b=D["data_"+a.label],ba?b.hasOwnProperty(ba)?B.text(b[ba]):B.text(ba):b.hasOwnProperty(F)&&B.text(b[F]),Da?u.html(Da(b)):null!=Ea?u.text(Ea(b)):b.hasOwnProperty(Fa)?u.text(b[Fa]):u.text(b[z]),ya(d3.event.pageX,d3.event.pageY),la(O[a.label],!0))}function ya(a,c){Q.style("left",a-Ga-140+"px").style("top",c-0-250+"px")}function ka(a,c){"from"==c?la(a,!1):"link"==c?Ca(a,!1):"to"==c&&la(O[a.label],!1);Q.transition().duration(500).style("opacity",
	"0")}function Ca(a,c){var b=1==c?.6:.1;d3.select(document.getElementById("l_"+a.Key)).transition(1==c?150:550).style("fill-opacity",b).style("stroke-opacity",b);d3.select(document.getElementById("a_"+a.Key)).transition().style("fill-opacity",1==c?b:.2);d3.select(document.getElementById("c_"+a[p])).transition(1==c?150:550).style("opacity",1==c?1:0);d3.select(document.getElementById("t_"+a[r])).transition(550).style("fill",1==c?Xa:sa).style("font-size","12px").style("stroke-width",2)}function la(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       c){a.relatedLinks.forEach(function(a){Ca(a,c)})}var C=600,ma,x,na,X,Y,E,ca,Ta,Pa,Ya,Qa,Na,qa,ra,ia,ta="#F80018 #0543bc #ccea06 #00AC6B #007046 #35D699 #60D6A9".split(" "),sa="#000000",Xa="#0000ff",Ra=.05,Sa=.2,Wa=.4,Va="#555",Ga,Za,g={width:"245px",fontSize:"12px",textAlign:"center",background:"#ffffff",border:"1px solid #dddddd",fontFamily:"arial,helvetica,sans-serif",color:"#333333",borderRadius:"5px",showShadow:!0,showRule:!0,ruleColor:"#ddd",ruleWeight:"1px",ruleMargin:"1px auto 3px",ruleMarginB:"7px",
	ruleMarginT:"0px",titleSize:"12px",titleColor:"#000000",titleAglin:"center"};this.setToolpitStyle=function(a){if(a)for(var c in a)g[c]=a[c]};this.setLabelColor=function(a,c){a&&(sa=a);c&&(Xa=c)};this.setFromFillColors=function(a,c,b,e,f){ta=a;c&&(Ra=c);b&&(Sa=b)};this.setToBorStyle=function(a,c){a&&(Wa=c);c&&(Va=a)};this.initGaph=function(ff,a,c,b){var e;e="<div id='bpg' style='width: 1000px;position: absolute;margin:auto;font-weight: 300;font-size:12px;font-family:Helvetica Neue, Helvetica;'><div id='mainDiv' style='width:1000px; height: 1000px;position:relative;'><div id='svgDiv' style='width: 800px; height: 800px;margin: auto;'/></div>";
	var f="left:0px; top:0px; opacity:4.5e-7;position:absolute;min-height:60px;height:60px;height:auto;text-align:center;pointer-events:none;padding:10px;position:absolute;";g.showShadow&&(f+="box-shadow: 0 1px 5px rgba(0,0,0,0.4);-moz-box-shadow: 0 1px 5px rgba(0,0,0,0.4);");var f=f+("width:"+g.width+";"),f=f+("font-size:"+g.fontSize+";"),f=f+("text-align:"+g.textAlign+";"),f=f+("background-color:"+g.background+";"),f=f+("border:"+g.border+";"),f=f+("font-family:"+g.fontFamily+";"),f=f+("color:"+g.color+
		";"),f=f+("border-radius:"+g.borderRadius+";"),f="<div id='toolTip' style='"+f+"'>",d;d="word-wrap:break-word;margin-bottom:0px;height:auto;display:block;word-break:break-all;min-height:20px;"+("color:"+g.titleColor+";");d+="font-size:"+g.titleSize+";";d+="text-align:"+g.titleAglin+";";d+="width:"+g.width+";";f+="<div id='header1' style='"+d+"'></div>";d=""+("margin:"+g.ruleMargin+";");d+="margin-bottom:"+g.ruleMarginB+";";d+="margin-top:"+g.ruleMarginT+";";d+="height:"+g.ruleWeight+";";d+="background-color:"+
	g.ruleColor+";";f+="<div style='"+d+"'></div>";d="word-wrap:break-word;margin-bottom:5px;height:auto;display:block;word-break: break-all;min-height:20px;"+("width:"+g.width+";");d+="font-size:"+g.fontSize+";";d+="text-align:"+g.textAlign+";";d+="color:"+g.color+";";f=f+("<div id='head'  style='"+d+"'></div>")+"</div>";e+=f;e+="</div>";/*document.write(e);*/d3.select(ff).html(e);Q=d3.select(document.getElementById("toolTip"));u=d3.select(document.getElementById("head"));B=d3.select(document.getElementById("header1"));Za=d3.select(document.getElementById("bpg"));
	this.setGaphaSize(a,c,b);return Za};this.setGaphaSize=function(a,c,b){b||(b="center");C=Math.max(200,Math.min(a,c)-120);ma=C/2;x=ma-132;na=x-50;X=x-20;Y=ma-x+(x-na);E=ma;Ga="right"==b?a-C:"left"==b?0:(a-C)/2;d3.select(document.getElementById("mainDiv")).style("width",C+"px").style("height",C+"px").style("left",Ga+"px").style("top","5px");d3.select(document.getElementById("bpg")).style("width",a-20+"px").style("width",c-20+"px");ca=d3.select(document.getElementById("svgDiv")).style("width",C+"px").style("height",
	C+"px").append("svg").attr("id","svg").style("width",C+"px").style("height",C+"px");Ta=ca.append("g").attr("class","chords").attr("transform","translate("+E+","+E+")");Pa=ca.append("g").attr("class","links").attr("transform","translate("+E+","+E+")");Ya=ca.append("g").attr("transform","translate("+E+","+E+")").style("opacity",0);Ya.append("path");Qa=ca.append("g").attr("class","nodes").attr("transform","translate("+Y+","+Y+")");Na=d3.layout.pack().sort(null).size([2*na,2*na]).padding(1.5);qa=d3.layout.chord().padding(.05).sortSubgroups(d3.descending).sortChords(d3.descending);
	ra=d3.svg.diagonal.radial();d3.svg.arc().innerRadius(x).outerRadius(x+10);d3.format(",d");d3.scale.category20c();$a=!0};var $a=!1,oa=[],U=[],T=[],L=[],fb=[],gb=[],La=[],D={},O={},N={},Ma=[],da=[],W={},pa={},Oa=[],V=[],S=[],ua=0,K,Ja,Ka=2,da=[],Q,u,B,Ha=0,ga="",ha="",M="",p="",R="",y="",r="",F="",w="",z="",wa=null,va=null,Ea=null,Da=null,Aa=null,za=null,Z="",xa="",ba="",Fa="",aa="",Ba="",G=!1,I=[],J=[],q=[];this.setToolpitFromFiled=function(a,c,b,e){wa=b;Z=a;xa=c;va=e};this.setToolpitToFiled=function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             c,b,e){Ea=b;ba=a;Fa=c;Da=e};this.setToolpitLinkFiled=function(a,c,b,e){aa=a;Ba=c;Aa=b;za=e};this.setLinkFromFiled=function(a,c,b){p=a;R=c;y=b};this.setLinkToFiled=function(a,c,b){r=a;F=c;z=b};this.setLinkValueFiled=function(a){w=a};this.setDataProvider=function(a,c,b){Ha=1;G=!1;ga=c;ha=b;M=a;c&&b||!a||(G=!0)};this.setFileSource=function(a,c,b){Ha=0;G=!1;ga=c;ha=b;M=a;c&&b||!a||(G=!0)};this.startRender=function(){$a&&""!=p&&""!=r&&""!=F&&(0==Ha?t():(S=[],G?q=M:(I=ga,q=M,J=ha),l()),l())};this.getToDataValue=
	function(a){return D&&D.hasOwnProperty("data_"+a)?D["data_"+a]:null};this.getFromDataValue=function(a){return D&&D.hasOwnProperty(a)?N[a]:null}}var normalUtils=function(){};normalUtils.copyObj=function(l,h){var t={},k;for(k in l)h&&0<=h.indexOf(","+k+",")||(t[k]=l[k]);return t};normalUtils.copyAttObj=function(l,h){for(var t={},k=0;k<h.length;k++)l.hasOwnProperty(h[k])&&(t[h[k]]=l[h[k]]);return t};normalUtils.getItemOnlyAtt=function(l,h){for(;;)if(l.hasOwnProperty(h))h+=0;else break;return h};
function HasMap(){var l=[],h={},t=[];this.addChild=function(k,A){if(!h.hasOwnProperty(k))return l.push(A),t.push(k),h[k]=l.length-1,!0;this.setChild(k,A);return!1};this.getChild=function(k){return h.hasOwnProperty(k)?l[parseInt(h[k])]:null};this.hasKey=function(k){return h.hasOwnProperty(k)};this.setChild=function(k,t){return h.hasOwnProperty(k)?(l[parseInt(h[k])]=t,!0):!1};this.removeChild=function(k){if(h.hasOwnProperty(k)){var A=int(h[k]);l.splice(A,1);t.splice(A,1);delete h[k];k=t.length;for(var H=
	A;H<k;H++)int(h[t[H]])>A&&--h[t[H]]}};this.removeAll=function(){l=[];t=[];h={}};this.getKeyIndex=function(k){return h.hasOwnProperty(k)?h[k]:-1};this.getValueList=function(){return l};this.getKeyList=function(){return t};this.length=function(){return t.length}};